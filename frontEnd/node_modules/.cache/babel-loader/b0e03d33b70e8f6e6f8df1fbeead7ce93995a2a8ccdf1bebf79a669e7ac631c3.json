{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import'./Chat.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Chat=_ref=>{let{chatId,selectedChat}=_ref;const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const user=JSON.parse(localStorage.getItem('user'));useEffect(()=>{axios.get(\"http://localhost:8081/messages/\".concat(chatId)).then(res=>{console.log(\"Fetched messages:\",res.data);setMessages(res.data);}).catch(err=>{console.error(\"Error fetching messages:\",err);});},[chatId]);const handleSendMessage=()=>{if(newMessage.trim()==='')return;const messageData={chat_id:chatId,user_email:user.email,message:newMessage,postImage:selectedChat.postImage,postTitle:selectedChat.postTitle};axios.post('http://localhost:8081/messages',messageData).then(res=>{setMessages([...messages,{...messageData,timestamp:new Date()}]);setNewMessage('');}).catch(err=>{console.error(\"Error sending message:\",err);});};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:8081/\".concat(selectedChat.profile_pic),alt:selectedChat.name,className:\"chat-profile-pic\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{children:selectedChat.name})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-messages-container\",children:[selectedChat.postImage&&/*#__PURE__*/_jsxs(\"div\",{className:\"message-post-info\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:8081/\".concat(selectedChat.postImage),alt:selectedChat.postTitle,className:\"message-post-image\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedChat.postTitle})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-messages\",children:messages.map((msg,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"chat-message \".concat(msg.user_email===user.email?'sent':'received'),children:[/*#__PURE__*/_jsx(\"p\",{children:msg.message}),/*#__PURE__*/_jsx(\"small\",{className:\"timestamp\",children:new Date(msg.timestamp).toLocaleString()})]},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-input\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newMessage,onChange:e=>setNewMessage(e.target.value),placeholder:\"Type your message...\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendMessage,children:\"Send\"})]})]});};export default Chat;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","Chat","_ref","chatId","selectedChat","messages","setMessages","newMessage","setNewMessage","user","JSON","parse","localStorage","getItem","get","concat","then","res","console","log","data","catch","err","error","handleSendMessage","trim","messageData","chat_id","user_email","email","message","postImage","postTitle","post","timestamp","Date","className","children","src","profile_pic","alt","name","map","msg","index","toLocaleString","type","value","onChange","e","target","placeholder","onClick"],"sources":["C:/Users/Vanja/Desktop/Vanja/GitHub/Book-Swap-Local/frontEnd/src/Pages/Chat.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport './Chat.css';\r\n\r\nconst Chat = ({ chatId, selectedChat }) => {\r\n    const [messages, setMessages] = useState([]);\r\n    const [newMessage, setNewMessage] = useState('');\r\n    const user = JSON.parse(localStorage.getItem('user'));\r\n\r\n    useEffect(() => {\r\n        axios.get(`http://localhost:8081/messages/${chatId}`)\r\n            .then(res => {\r\n                console.log(\"Fetched messages:\", res.data);\r\n                setMessages(res.data);\r\n            })\r\n            .catch(err => {\r\n                console.error(\"Error fetching messages:\", err);\r\n            });\r\n    }, [chatId]);\r\n\r\n    const handleSendMessage = () => {\r\n        if (newMessage.trim() === '') return;\r\n\r\n        const messageData = {\r\n            chat_id: chatId,\r\n            user_email: user.email,\r\n            message: newMessage,\r\n            postImage: selectedChat.postImage,\r\n            postTitle: selectedChat.postTitle\r\n        };\r\n\r\n        axios.post('http://localhost:8081/messages', messageData)\r\n            .then(res => {\r\n                setMessages([...messages, { ...messageData, timestamp: new Date() }]);\r\n                setNewMessage('');\r\n            })\r\n            .catch(err => {\r\n                console.error(\"Error sending message:\", err);\r\n            });\r\n    };\r\n\r\n    return (\r\n        <div className=\"chat-container\">\r\n            <div className=\"chat-header\">\r\n                <img src={`http://localhost:8081/${selectedChat.profile_pic}`} alt={selectedChat.name} className=\"chat-profile-pic\" />\r\n                <div>\r\n                    <h2>{selectedChat.name}</h2>\r\n                </div>\r\n            </div>\r\n            <div className=\"chat-messages-container\">\r\n                {selectedChat.postImage && (\r\n                    <div className=\"message-post-info\">\r\n                        <img src={`http://localhost:8081/${selectedChat.postImage}`} alt={selectedChat.postTitle} className=\"message-post-image\" />\r\n                        <span>{selectedChat.postTitle}</span>\r\n                    </div>\r\n                )}\r\n                <div className=\"chat-messages\">\r\n                    {messages.map((msg, index) => (\r\n                        <div key={index} className={`chat-message ${msg.user_email === user.email ? 'sent' : 'received'}`}>\r\n                            <p>{msg.message}</p>\r\n                            <small className=\"timestamp\">{new Date(msg.timestamp).toLocaleString()}</small>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n            <div className=\"chat-input\">\r\n                <input\r\n                    type=\"text\"\r\n                    value={newMessage}\r\n                    onChange={e => setNewMessage(e.target.value)}\r\n                    placeholder=\"Type your message...\"\r\n                />\r\n                <button onClick={handleSendMessage}>Send</button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Chat;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}