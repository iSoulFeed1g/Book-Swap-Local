{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate,useLocation}from'react-router-dom';import'./Home.css';import Layout from'./Layout';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";function Home(){const[posts,setPosts]=useState([]);const[searchQuery,setSearchQuery]=useState('');const[filter,setFilter]=useState({sortBy:'newest',genre:''});const navigate=useNavigate();const location=useLocation();const user=JSON.parse(localStorage.getItem('user'));useEffect(()=>{const params=new URLSearchParams(location.search);const searchTerm=params.get('searchTerm')||'';const sortBy=params.get('sortBy')||'newest';const genre=params.get('genre')||'';setSearchQuery(searchTerm);setFilter({sortBy,genre});},[location.search]);useEffect(()=>{fetchPosts();},[filter,searchQuery]);const fetchPosts=()=>{axios.get('http://localhost:8081/posts',{params:{...filter,searchTerm:searchQuery}})// Changed query to searchTerm\n.then(res=>{const postsWithUsernames=res.data.map(post=>({...post,user_name:post.user_name||'Unknown'// Default value\n}));setPosts(postsWithUsernames);}).catch(err=>{console.log(\"Error fetching posts:\",err);});};const handleSearch=query=>{setSearchQuery(query);setFilter({...filter,query});navigate(\"/home?searchTerm=\".concat(query));};const handleFilterChange=newFilter=>{setFilter(newFilter);};const handleCardClick=async postId=>{try{// Fetch the post details\nconst response=await axios.get(\"http://localhost:8081/post/\".concat(postId));const post=response.data;// Check if the user is the owner of the post\nconst user=JSON.parse(localStorage.getItem('user'));if(post.user_email===user.email){navigate(\"/own-post/\".concat(postId));}else{navigate(\"/post/\".concat(postId));}}catch(error){console.error(\"Error fetching post details:\",error);}};return/*#__PURE__*/_jsx(Layout,{onSearch:handleSearch,onFilterChange:handleFilterChange,children:/*#__PURE__*/_jsx(\"div\",{className:\"home-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"posts-list\",children:posts.length?posts.map(post=>/*#__PURE__*/_jsxs(\"div\",{className:\"post-card\",onClick:()=>handleCardClick(post.id),children:[/*#__PURE__*/_jsx(\"div\",{className:\"post-price-container\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"post-price\",children:[\"\\u20AC\",parseFloat(post.price).toFixed(2)]})}),/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:8081/\".concat(post.picture),alt:post.title,className:\"post-image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-details\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"post-title\",children:post.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"post-author\",children:[\"Author: \",post.author]}),/*#__PURE__*/_jsxs(\"p\",{className:\"post-genre\",children:[\"Genre: \",post.genre]}),/*#__PURE__*/_jsxs(\"p\",{className:\"post-user\",children:[\"Posted by: \",post.user_name]})]})]},post.id)):/*#__PURE__*/_jsx(\"p\",{children:\"No posts found\"})})})});}export default Home;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","useLocation","Layout","jsxs","_jsxs","jsx","_jsx","Home","posts","setPosts","searchQuery","setSearchQuery","filter","setFilter","sortBy","genre","navigate","location","user","JSON","parse","localStorage","getItem","params","URLSearchParams","search","searchTerm","get","fetchPosts","then","res","postsWithUsernames","data","map","post","user_name","catch","err","console","log","handleSearch","query","concat","handleFilterChange","newFilter","handleCardClick","postId","response","user_email","email","error","onSearch","onFilterChange","children","className","length","onClick","id","parseFloat","price","toFixed","src","picture","alt","title","author"],"sources":["C:/Users/Vanja/Desktop/Vanja/GitHub/Book-Swap-Local/frontEnd/src/Pages/Home.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport './Home.css';\r\nimport Layout from './Layout';\r\n\r\nfunction Home() {\r\n  const [posts, setPosts] = useState([]);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [filter, setFilter] = useState({ sortBy: 'newest', genre: '' });\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const user = JSON.parse(localStorage.getItem('user'));\r\n\r\n  useEffect(() => {\r\n    const params = new URLSearchParams(location.search);\r\n    const searchTerm = params.get('searchTerm') || '';\r\n    const sortBy = params.get('sortBy') || 'newest';\r\n    const genre = params.get('genre') || '';\r\n    setSearchQuery(searchTerm);\r\n    setFilter({ sortBy, genre });\r\n  }, [location.search]);\r\n\r\n  useEffect(() => {\r\n    fetchPosts();\r\n  }, [filter, searchQuery]);\r\n\r\n  const fetchPosts = () => {\r\n    axios.get('http://localhost:8081/posts', { params: { ...filter, searchTerm: searchQuery } }) // Changed query to searchTerm\r\n      .then(res => {\r\n        const postsWithUsernames = res.data.map(post => ({\r\n          ...post,\r\n          user_name: post.user_name || 'Unknown', // Default value\r\n        }));\r\n        setPosts(postsWithUsernames);\r\n      })\r\n      .catch(err => {\r\n        console.log(\"Error fetching posts:\", err);\r\n      });\r\n  };\r\n\r\n  const handleSearch = (query) => {\r\n    setSearchQuery(query);\r\n    setFilter({ ...filter, query });\r\n    navigate(`/home?searchTerm=${query}`);\r\n  };\r\n\r\n  const handleFilterChange = (newFilter) => {\r\n    setFilter(newFilter);\r\n  };\r\n\r\n const handleCardClick = async (postId) => {\r\n    try {\r\n        // Fetch the post details\r\n        const response = await axios.get(`http://localhost:8081/post/${postId}`);\r\n        const post = response.data;\r\n\r\n        // Check if the user is the owner of the post\r\n        const user = JSON.parse(localStorage.getItem('user'));\r\n        if (post.user_email === user.email) {\r\n            navigate(`/own-post/${postId}`);\r\n        } else {\r\n            navigate(`/post/${postId}`);\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Error fetching post details:\", error);\r\n    }\r\n};\r\n\r\n\r\n  return (\r\n    <Layout onSearch={handleSearch} onFilterChange={handleFilterChange}>\r\n      <div className=\"home-container\">\r\n        <div className=\"posts-list\">\r\n          {posts.length ? posts.map(post => (\r\n            <div key={post.id} className=\"post-card\" onClick={() => handleCardClick(post.id)}>\r\n              <div className=\"post-price-container\">\r\n                <p className=\"post-price\">â‚¬{parseFloat(post.price).toFixed(2)}</p>\r\n              </div>\r\n              <img src={`http://localhost:8081/${post.picture}`} alt={post.title} className=\"post-image\" />\r\n              <div className=\"post-details\">\r\n                <h2 className=\"post-title\">{post.title}</h2>\r\n                <p className=\"post-author\">Author: {post.author}</p>\r\n                <p className=\"post-genre\">Genre: {post.genre}</p>\r\n                <p className=\"post-user\">Posted by: {post.user_name}</p>\r\n              </div>\r\n            </div>\r\n          )) : <p>No posts found</p>}\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n\r\nexport default Home;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}