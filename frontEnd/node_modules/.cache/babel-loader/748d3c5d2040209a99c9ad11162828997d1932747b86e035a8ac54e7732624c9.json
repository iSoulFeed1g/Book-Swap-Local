{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import'./Inbox.css';import{useParams,useNavigate}from'react-router-dom';import Layout from'./Layout';import Chat from'./Chat';// Import the Chat component\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Inbox(){const[chats,setChats]=useState([]);const[selectedChat,setSelectedChat]=useState(null);const{chatId}=useParams();const user=JSON.parse(localStorage.getItem('user'));const navigate=useNavigate();useEffect(()=>{if(user&&user.id){axios.get(\"http://localhost:8081/inbox/\".concat(user.id)).then(res=>{setChats(res.data);}).catch(err=>{console.error(\"Error fetching inbox:\",err);});}},[user]);useEffect(()=>{if(chatId&&chats.length){const chat=chats.find(chat=>chat.id===parseInt(chatId));if(chat){setSelectedChat(chat);}}},[chatId,chats]);if(!user){return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsx(\"div\",{className:\"please-login\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-message\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Please log in to access your Inbox.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary login-button\",onClick:()=>navigate('/login'),children:\"Login / Sign Up\"})]})})});}const handleChatClick=chat=>{setSelectedChat(chat);navigate(\"/inbox/\".concat(chat.id));};const handleSearch=query=>{console.log('Search query:',query);};return/*#__PURE__*/_jsx(Layout,{onSearch:handleSearch,children:/*#__PURE__*/_jsxs(\"div\",{className:\"inbox-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inbox-sidebar\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Inbox\"}),/*#__PURE__*/_jsx(\"div\",{className:\"inbox-list\",children:chats.map(chat=>chat.name!==user.name&&/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleChatClick(chat),className:\"inbox-item \".concat(selectedChat&&selectedChat.id===chat.id?'active':''),children:[/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:8081/\".concat(chat.profile_pic),alt:chat.name,className:\"inbox-profile-pic\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"inbox-text\",children:[/*#__PURE__*/_jsx(\"p\",{className:chat.lastMessageSender===user.id?\"\":\"bold\",children:chat.name}),/*#__PURE__*/_jsx(\"p\",{className:\"last-message\",children:chat.lastMessage})]})]},chat.id))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-area\",children:selectedChat?/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Chat,{chatId:selectedChat.id,selectedChat:selectedChat},selectedChat.id)}):/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-message\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your messages\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Send a message to start a chat.\"})]})})]})});}export default Inbox;","map":{"version":3,"names":["React","useState","useEffect","axios","useParams","useNavigate","Layout","Chat","jsx","_jsx","jsxs","_jsxs","Inbox","chats","setChats","selectedChat","setSelectedChat","chatId","user","JSON","parse","localStorage","getItem","navigate","id","get","concat","then","res","data","catch","err","console","error","length","chat","find","parseInt","children","className","onClick","handleChatClick","handleSearch","query","log","onSearch","map","name","src","profile_pic","alt","lastMessageSender","lastMessage"],"sources":["C:/Users/Vanja/Desktop/Vanja/GitHub/Book-Swap-Local/frontEnd/src/Pages/Inbox.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport './Inbox.css';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport Layout from './Layout';\r\nimport Chat from './Chat'; // Import the Chat component\r\n\r\nfunction Inbox() {\r\n    const [chats, setChats] = useState([]);\r\n    const [selectedChat, setSelectedChat] = useState(null);\r\n    const { chatId } = useParams();\r\n    const user = JSON.parse(localStorage.getItem('user'));\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        if (user && user.id) {\r\n            axios.get(`http://localhost:8081/inbox/${user.id}`)\r\n                .then(res => {\r\n                    setChats(res.data);\r\n                })\r\n                .catch(err => {\r\n                    console.error(\"Error fetching inbox:\", err);\r\n                });\r\n        }\r\n    }, [user]);\r\n\r\n    useEffect(() => {\r\n        if (chatId && chats.length) {\r\n            const chat = chats.find(chat => chat.id === parseInt(chatId));\r\n            if (chat) {\r\n                setSelectedChat(chat);\r\n            }\r\n        }\r\n    }, [chatId, chats]);\r\n\r\n    if (!user) {\r\n        return (\r\n            <Layout>\r\n                <div className=\"please-login\">\r\n                    <div className=\"login-message\">\r\n                        <p>Please log in to access your Inbox.</p>\r\n                        <button className=\"btn btn-primary login-button\" onClick={() => navigate('/login')}>\r\n                            Login / Sign Up\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </Layout>\r\n        );\r\n    }\r\n\r\n    const handleChatClick = (chat) => {\r\n        setSelectedChat(chat);\r\n        navigate(`/inbox/${chat.id}`);\r\n    };\r\n\r\n    const handleSearch = (query) => {\r\n        console.log('Search query:', query);\r\n    };\r\n\r\n    return (\r\n        <Layout onSearch={handleSearch}>\r\n            <div className=\"inbox-page\">\r\n                <div className=\"inbox-sidebar\">\r\n                    <h1>Inbox</h1>\r\n                    <div className=\"inbox-list\">\r\n                        {chats.map(chat => (\r\n                            chat.name !== user.name && (\r\n                                <div key={chat.id} onClick={() => handleChatClick(chat)} className={`inbox-item ${selectedChat && selectedChat.id === chat.id ? 'active' : ''}`}>\r\n                                    <img src={`http://localhost:8081/${chat.profile_pic}`} alt={chat.name} className=\"inbox-profile-pic\" />\r\n                                    <div className=\"inbox-text\">\r\n                                        <p className={chat.lastMessageSender === user.id ? \"\" : \"bold\"}>{chat.name}</p>\r\n                                        <p className=\"last-message\">{chat.lastMessage}</p>\r\n                                    </div>\r\n                                </div>\r\n                            )\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n                <div className=\"chat-area\">\r\n                    {selectedChat ? (\r\n                        <div>\r\n                            <Chat key={selectedChat.id} chatId={selectedChat.id} selectedChat={selectedChat} />\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"welcome-message\">\r\n                            <h2>Your messages</h2>\r\n                            <p>Send a message to start a chat.</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </Layout>\r\n    );\r\n}\r\n\r\nexport default Inbox;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}