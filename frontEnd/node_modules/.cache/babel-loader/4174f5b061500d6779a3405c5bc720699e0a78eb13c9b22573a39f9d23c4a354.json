{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import'./ChatModal.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ChatModal(_ref){let{post,user,onClose}=_ref;const[message,setMessage]=useState('');const handleSendMessage=async()=>{if(!message.trim()){return;}try{const chatData={buyer_id:user.id,seller_id:post.user_id,post_id:post.id,postImage:post.picture,// Include postImage\npostTitle:post.title,// Include postTitle\nuser_email:user.email// Include user_email\n};const res=await axios.post('http://localhost:8081/createChat',chatData);const chatId=res.data.chat_id;const messageData={chat_id:chatId,buyer_id:user.id,seller_id:post.user_id,post_id:post.id,postImage:post.picture,// Ensure the post image and title are sent\npostTitle:post.title,message:message,user_email:user.email};await axios.post('http://localhost:8081/messages',messageData);onClose();// Close the modal after sending the message\n}catch(error){console.error('Error sending message:',error);}};// Function to handle click on overlay background\nconst handleOverlayClick=e=>{if(e.target===e.currentTarget){onClose();// Close modal if the overlay is clicked\n}};return/*#__PURE__*/_jsx(\"div\",{className:\"chat-modal-overlay\",onClick:handleOverlayClick,children:/*#__PURE__*/_jsxs(\"div\",{className:\"chat-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Contact Seller\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"close-button\",children:\"X\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post-preview-container\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:8081/\".concat(post.picture),alt:post.title,className:\"post-image-preview\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:post.title}),/*#__PURE__*/_jsx(\"p\",{children:post.description})]})]}),/*#__PURE__*/_jsx(\"textarea\",{value:message,onChange:e=>setMessage(e.target.value),placeholder:\"Type your message...\",className:\"message-textarea\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-modal-footer\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleSendMessage,className:\"send-button\",children:\"Send\"})})]})});}export default ChatModal;","map":{"version":3,"names":["React","useState","axios","jsx","_jsx","jsxs","_jsxs","ChatModal","_ref","post","user","onClose","message","setMessage","handleSendMessage","trim","chatData","buyer_id","id","seller_id","user_id","post_id","postImage","picture","postTitle","title","user_email","email","res","chatId","data","chat_id","messageData","error","console","handleOverlayClick","e","target","currentTarget","className","onClick","children","src","concat","alt","description","value","onChange","placeholder"],"sources":["C:/Users/Vanja/Desktop/Vanja/GitHub/Book-Swap-Local/frontEnd/src/Pages/ChatModal.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport './ChatModal.css';\r\n\r\nfunction ChatModal({ post, user, onClose }) {\r\n    const [message, setMessage] = useState('');\r\n\r\n    const handleSendMessage = async () => {\r\n        if (!message.trim()) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const chatData = {\r\n                buyer_id: user.id,\r\n                seller_id: post.user_id,\r\n                post_id: post.id,\r\n                postImage: post.picture, // Include postImage\r\n                postTitle: post.title,   // Include postTitle\r\n                user_email: user.email   // Include user_email\r\n            };\r\n\r\n            const res = await axios.post('http://localhost:8081/createChat', chatData);\r\n\r\n            const chatId = res.data.chat_id;\r\n\r\n            const messageData = {\r\n                chat_id: chatId,\r\n                buyer_id: user.id,\r\n                seller_id: post.user_id,\r\n                post_id: post.id,\r\n                postImage: post.picture, // Ensure the post image and title are sent\r\n                postTitle: post.title,\r\n                message: message,\r\n                user_email: user.email\r\n            };\r\n\r\n            await axios.post('http://localhost:8081/messages', messageData);\r\n\r\n            onClose(); // Close the modal after sending the message\r\n        } catch (error) {\r\n            console.error('Error sending message:', error);\r\n        }\r\n    };\r\n\r\n    // Function to handle click on overlay background\r\n    const handleOverlayClick = (e) => {\r\n        if (e.target === e.currentTarget) {\r\n            onClose();  // Close modal if the overlay is clicked\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"chat-modal-overlay\" onClick={handleOverlayClick}>\r\n            <div className=\"chat-modal\">\r\n                <div className=\"chat-modal-header\">\r\n                    <h2>Contact Seller</h2>\r\n                    <button onClick={onClose} className=\"close-button\">X</button>\r\n                </div>\r\n                <div className=\"chat-modal-body\">\r\n                    <div className=\"post-preview-container\">\r\n                        <img src={`http://localhost:8081/${post.picture}`} alt={post.title} className=\"post-image-preview\" />\r\n                        <div className=\"post-info\">\r\n                            <h3>{post.title}</h3>\r\n                            <p>{post.description}</p>\r\n                        </div>\r\n                    </div>\r\n                    <textarea\r\n                        value={message}\r\n                        onChange={(e) => setMessage(e.target.value)}\r\n                        placeholder=\"Type your message...\"\r\n                        className=\"message-textarea\"\r\n                    />\r\n                </div>\r\n                <div className=\"chat-modal-footer\">\r\n                    <button onClick={handleSendMessage} className=\"send-button\">Send</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ChatModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}